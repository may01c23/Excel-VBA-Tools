# Excel VBA 工具箱 (Excel-VBA-Toolkit)

这是一个专门为提高 Excel 数据处理效率而开发的 VBA 工具集合。目前包含批量图片自动化排版、增强型多条件模糊筛选等功能。

## 🛠 功能介绍

### 1. 图片自动化导入工具 (`ImagesMatrixImport.bas`)

**解决痛点：** 当你有成百上千张图片，文件名包含分类信息（如 `手机_小米_001.jpg`），需要按类别自动排列到表格的行和列中。

* **智能追加：** 自动识别已有行、列标题，不存在则自动创建，实现数据的动态追加 。

* **灵活解析：** 支持自定义分隔符和列名位置（开头或结尾） 。

* **自动排版：** 自动调整行高、列宽，并使图片在单元格内居中显示 。

* **清理机制：** 导入前自动删除目标单元格原有的旧图片，避免堆叠 。

### 2. 增强型多关键词模糊筛选 (`MultiFilterFuzzy.bas`)

**解决痛点：** Excel 原生筛选只能进行简单的模糊匹配，无法一次性筛选出“包含 A 或 包含 B ”的记录。

* **逻辑并集：** 输入 `关键词1, 关键词2`，即可筛选出包含其中任意一个关键词的所有行 。

* **内存加速：** 采用字典 (Dictionary) 与内存数组处理技术，即使在大型数据表中也能快速响应 。

* **智能识别：** 自动处理全角/半角逗号，自动识别当前激活单元格所在的筛选区域 。

---

## 🚀 安装与使用

### 导入代码

1. 在 Excel 中按 `Alt + F11` 打开 VBA 编辑器。
2. 在左侧项目栏点击右键 -> `Import File...` (导入文件)。
3. 选择本仓库中的 `.bas` 文件。

### 运行宏

**图片导入：** 选中一个单元格作为表格的左上角（起点），运行 `ImagesMatrixImport`，按提示输入分隔符和尺寸即可 。

**模糊筛选：** 选中你想要筛选的那一列中的任意单元格，运行 `MultiFilterFuzzy`，在弹窗中输入关键词 。

---

## 📂 文件说明

| 文件名 | 类型 | 说明 |
| --- | --- | --- |
| `ImagesMatrixImport.bas` | 标准模块 | 图片矩阵导入核心逻辑 |
| `MultiFilterFuzzy.bas` | 标准模块 | 多关键词筛选功能 |

---

## 📝 配置参数参考 (图片导入)

在运行图片导入时，你会看到类似 `_, -1, 100, 50` 的配置框：

1. **分隔符**：文件名中拆分信息的符号（如 `_`） 。

2. **列名索引**：`0` 代表分隔后的第一个词作为列标题，`-1` 代表最后一个 。

3. **行高/列宽**：控制单元格大小，图片会根据此尺寸自动缩放 。

---

## 🤝 贡献

欢迎提交 Issue 或 Pull Request 来改进这些工具！
